---
title: 참새작 AI 만들기 2 - 패, 손패, 버림패
toc: true
date: 2022-03-22 10:11:10
tags: [SuzumeAI, AI, Reinforcement Learning]
categories: [AI, Reinforcement Learning]
---

## 패
참새작에서 사용되는 패는 총 44장이다. 이 패를 역을 계산하기 쉬운 형태로 변형해야 한다.
역에 영향을 미치는 속성은 다음과 같다.

* 패의 종류(1~9, 녹, 발)
* 패의 색(적색, 녹색, 검정-나머지)
* 귀족패(1, 9, 녹, 발)

시뮬레이션을 더 빠르게 하기 위해서, 패의 속성을 미리 계산해 둔 테이블을 사용한다. 패의 개수와 패의 속성은 게임을 하는 동안 변하지 않기 때문에, 작은 크기의 테이블로도 충분히 속성을 관리할 수 있다. Card.CardTable은 그 테이블을 생성하고 관리하는 클래스이다.

## 손패와 버림패
참새작을 이루는 요소 중 가장 중요한 요소이다. 패는 패산 -> 손패 -> 버림패 순으로 이동하기 때문에 손패에서 버림패를 관리하는 것이 좋다. 현재 상태를 하나의 배열(Table)로 표현 가능하듯이, 손패와 버림패 역시 Table로 표현이 가능하다. 예를 들어, 손패에 있는 패를 1, 버렸을 경우는 2, 그 외의 경우를 0으로 표현할 수 있다. Numpy의 boolean indexing을 사용하여 손패와 버림패 목록을 간단하게 얻을 수 있다.

```
# 손패 목록
np.arange(44)[hand == 1]
# 버림패 목록
np.arange(44)[hand == 2]
```

또한 버림패같은 경우, 론을 할 수 있는지도 확인해야 하기 때문에 패를 찾아야 하는 list나 set보다 패의 위치가 어디인지 바로 확인할 수 있는 Table로 관리하는 것이 좋다. 

```
# list 기반
is_discarded = card in discard_zone # iteration 필요
# table 기반
is_discarded = hand[card] == 2 # 직접 접근
```

## 순서
상태를 하나의 배열로 관리하면 상태의 공간을 줄일 수 있지만, **순서**는 알 수 없다. 그러므로 만약 순서가 중요하다면(버린 순서), 순서를 저장할 공간을 따로 만들어야 한다.
Hand.DiscardZone은 버린 순서를 저장하는 클래스로 버린 순서를 list로 저장한다. 이 클래스는 게임에 직접적인 영향을 끼치지 않으며, 오직 상태를 출력할 때에만 사용된다.